/* =========================================================
   Permissions Page v3 (Neutral / Minimal Blue)
   Ø§Ù„Ù‡Ø¯Ù: Ù†ÙƒØ³Ø± Ø³ÙŠØ·Ø±Ø© Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ø£Ø²Ø±Ù‚ Ù…Ù† Ø§Ù„Ø«ÙŠÙ… ÙˆÙ†Ø®Ù„ÙŠÙ‡ Accent ÙÙ‚Ø·
   ========================================================= */

.permissions-page{
    --perm-border: #e5e7eb;
    --perm-border-2: #eef2f7;
    --perm-surface: #ffffff;
    --perm-subtle: #f8fafc;
    --perm-text: #0f172a;
    --perm-muted: #6b7280;
}

/* Card base */
.permissions-page .perm-card{
    border: 1px solid var(--perm-border);
    border-radius: 14px;
    background: var(--perm-surface);
    overflow: hidden;
    box-shadow: 0 2px 10px rgba(15,23,42,.04);
    position: relative;
}

/* Ø®Ø· Accent Ø±ÙÙŠØ¹ Ø¨Ø¯Ù„ Ø®Ù„ÙÙŠØ© Ø²Ø±Ù‚Ø§Ø¡ Ø¶Ø®Ù…Ø© */
.permissions-page .perm-card::before{
    content:"";
    position:absolute;
    top:0; left:0; right:0;
    height: 3px;
    background: rgba(var(--primary-rgb), .85);
}

/* ğŸ”¥ ÙƒØ³Ø± Ø«ÙŠÙ… card-header Ø§Ù„Ø£Ø²Ø±Ù‚ Ù„Ùˆ Ù„Ø³Ø§ Ù…ÙˆØ¬ÙˆØ¯ Ø¨Ø£ÙŠ Ù…ÙƒØ§Ù† */
.permissions-page .card-header{
    background: var(--perm-surface) !important;
    color: var(--perm-text) !important;
    border-bottom: 1px solid var(--perm-border-2) !important;
}
.permissions-page .card-header *{
    color: var(--perm-text) !important;
}

/* Header Ø§Ù„Ø®Ø§Øµ ÙÙŠÙ†Ø§ */
.permissions-page .perm-card-header{
    background: var(--perm-surface) !important;
    color: var(--perm-text) !important;
    border-bottom: 1px solid var(--perm-border-2);
    padding: 1rem 1.25rem;
}
.permissions-page .perm-card-header *{
    color: inherit;
}

.permissions-page .perm-title{
    font-weight: 800;
    font-size: 1rem;
    color: var(--perm-text);
}
.permissions-page .perm-subtitle{
    font-size: .85rem;
    color: var(--perm-muted);
    margin-top: .25rem;
}

/* Sidebar sticky */
.permissions-page .perm-sidebar{
    position: sticky;
    top: 90px; /* Ø¹Ø¯Ù‘Ù„Ù‡Ø§ Ø­Ø³Ø¨ Ø§Ù„Ù‡ÙŠØ¯Ø± */
}

/* mini info */
.permissions-page .perm-mini-note{
    background: var(--perm-subtle);
    border: 1px dashed var(--perm-border);
    border-radius: 12px;
    padding: .75rem 1rem;
    color: #334155;
}

/* Summary box */
.permissions-page .perm-summary{
    background: var(--perm-subtle);
    border: 1px solid var(--perm-border-2);
    border-radius: 12px;
    padding: 1rem;
}
.permissions-page .perm-summary-row{
    display:flex;
    align-items:center;
    justify-content: space-between;
    gap:.75rem;
    padding: .35rem 0;
    border-bottom: 1px solid var(--perm-border-2);
    margin-bottom: .5rem;
}
.permissions-page .perm-summary-row:last-of-type{
    border-bottom: none;
    margin-bottom: 0;
}
.permissions-page .perm-stats{
    display:grid;
    grid-template-columns: repeat(4, 1fr);
    gap: .6rem;
    margin-top: .75rem;
}
.permissions-page .perm-stat{
    background: var(--perm-surface);
    border: 1.5px solid var(--perm-border-2);
    border-radius: 12px;
    padding: .75rem .5rem;
    text-align:center;
    transition: all 0.2s ease;
}
.permissions-page .perm-stat:hover{
    border-color: rgba(var(--primary-rgb), .4);
    box-shadow: 0 2px 4px rgba(0,0,0,.05);
    transform: translateY(-1px);
}
.permissions-page .perm-stat .label{
    color: var(--perm-muted);
    font-size: .72rem;
    font-weight: 600;
    margin-bottom: .25rem;
}
.permissions-page .perm-stat .value{
    font-weight: 800;
    font-size: 1.15rem;
    color: var(--perm-text);
    line-height: 1.2;
}

/* Toolbar */
.permissions-page .perm-toolbar{
    border-top: 1px solid var(--perm-border-2);
    padding-top: 1.25rem;
    padding-bottom: 0.5rem;
    background: var(--perm-surface);
}


/* ===========================
   Search Bar (Permissions Tree)
   - icon inside input
   - soft clear button
   - no weird wrapping
   =========================== */

.permissions-page .perm-searchbar{
    display:flex;
    align-items:center;
    gap:.5rem;
    flex-wrap: nowrap;
}

.permissions-page .perm-searchfield{
    position: relative;
    flex: 1 1 auto;
    min-width: 280px;
}

.permissions-page .perm-search-icon{
    position:absolute;
    top:50%;
    transform: translateY(-50%);
    inset-inline-start: 14px;   /* RTL friendly */
    color:#94a3b8;
    pointer-events:none;
    font-size: 1.05rem;
    z-index: 1;
}

.permissions-page .perm-search-input{
    height: 44px;
    border-radius: 12px;
    padding-inline-start: 42px; /* Ù…Ø³Ø§Ø­Ø© Ù„Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø© */
    padding-inline-end: 42px; /* Ù…Ø³Ø§Ø­Ø© Ù„Ø²Ø± Ø§Ù„Ù…Ø³Ø­ */
    border: 1.5px solid var(--perm-border);
    font-size: 0.95rem;
    transition: all 0.2s ease;
}

.permissions-page .perm-search-input:focus{
    border-color: rgba(var(--primary-rgb), .85);
    box-shadow: 0 0 0 .25rem rgba(var(--primary-rgb), .15);
    outline: none;
}

.permissions-page .perm-clear-input{
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    inset-inline-end: 12px;
    background: transparent;
    border: none;
    color: #94a3b8;
    padding: 4px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 24px;
    height: 24px;
    border-radius: 50%;
    transition: all 0.2s ease;
    z-index: 2;
}

.permissions-page .perm-clear-input:hover{
    background: #f1f5f9;
    color: #64748b;
}

.permissions-page .perm-clear-input.d-none{
    display: none !important;
}

.permissions-page .perm-search-action{
    height: 44px;
    border-radius: 12px;
    white-space: nowrap;
    font-weight: 600;
    padding-inline: 1.25rem;
    transition: all 0.2s ease;
}

.permissions-page .perm-search-action:hover{
    transform: translateY(-1px);
    box-shadow: 0 4px 8px rgba(0,0,0,.1);
}

.permissions-page .perm-clear-btn{
    background:#f8fafc;
    border:1.5px solid var(--perm-border);
    color:#334155;
}

.permissions-page .perm-clear-btn:hover{
    background:#f1f5f9;
    border-color: rgba(var(--primary-rgb), .5);
    color: var(--perm-text);
}

/* Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ Ø®Ù„Ù‘ÙŠÙ‡Ø§ ØªØ±ØªÙ‘Ø¨ Ø­Ø§Ù„Ù‡Ø§ Ø¨Ø¯Ù„ Ù…Ø§ ØªØ¶ØºØ· */
@media (max-width: 768px){
    .permissions-page .perm-searchbar{
        flex-wrap: wrap;
    }
    .permissions-page .perm-searchfield{
        min-width: 100%;
    }
    .permissions-page .perm-search-action{
        flex: 1 1 auto;
        min-width: 120px;
    }
}


/* Filters */
.permissions-page .perm-filters{
    display:flex;
    flex-wrap:wrap;
    gap:.4rem;
    justify-content:flex-start;
}
.permissions-page .perm-filter{
    border: 1.5px solid var(--perm-border);
    background: var(--perm-surface);
    border-radius: 999px;
    padding: .4rem .75rem;
    font-size: .82rem;
    cursor:pointer;
    transition: all 0.2s ease;
    color: var(--perm-text);
    font-weight: 600;
    display: inline-flex;
    align-items: center;
    white-space: nowrap;
}
.permissions-page .perm-filter:hover{
    border-color: rgba(var(--primary-rgb), .65);
    background: rgba(var(--primary-rgb), .05);
    transform: translateY(-1px);
    box-shadow: 0 2px 4px rgba(0,0,0,.05);
}
.permissions-page .perm-filter.active{
    background: rgba(var(--primary-rgb), .12);
    border-color: rgba(var(--primary-rgb), .9);
    color: rgba(var(--primary-rgb), 1);
    font-weight: 700;
    box-shadow: 0 2px 6px rgba(var(--primary-rgb), .2);
}
.permissions-page .perm-filter i{
    font-size: 0.9em;
}

/* Groups */
.permissions-page .perm-group{
    border: 1px solid var(--perm-border-2);
    border-radius: 14px;
    margin-bottom: .75rem;
    background: var(--perm-surface);
}
.permissions-page .perm-group-header{
    display:flex;
    align-items:center;
    justify-content: space-between;
    padding: .75rem 1rem;
    background: var(--perm-subtle);
    cursor:pointer;
    user-select:none;
}
.permissions-page .perm-group-header:hover{
    background:#f1f5f9;
}
.permissions-page .perm-group-actions{
    display:flex;
    gap:.5rem;
}

/* Chevron rotation (ØµØ­) */
.permissions-page .perm-group-header[aria-expanded="false"] .perm-group-chevron{
    transform: rotate(-90deg);
}
.permissions-page .perm-group-chevron{
    transition: transform .2s ease;
}

/* Rows */
.permissions-page .perm-list{
    padding: .25rem .25rem .75rem .25rem;
}
.permissions-page .perm-row{
    border: 1px solid var(--perm-border-2);
    border-radius: 12px;
    padding: .75rem .75rem;
    margin: .5rem .75rem 0 .75rem;
    transition: .15s ease;
    background: var(--perm-surface);
}
.permissions-page .perm-row:hover{
    border-color: #dbeafe;
    box-shadow: 0 1px 0 rgba(0,0,0,.02);
}
.permissions-page .perm-row-main{
    display:flex;
    align-items:flex-start;
    justify-content: space-between;
    gap: 1rem;
}
.permissions-page .perm-row-title{
    font-weight: 800;
    font-size: .95rem;
    color: var(--perm-text);
}
.permissions-page .perm-row-desc{
    color:#64748b;
    font-size: .82rem;
    margin-top: .15rem;
}
.permissions-page .perm-row-code code{
    font-size: .75rem;
    color:#64748b;
}

.permissions-page .perm-row-side{
    min-width: 160px;
    display:flex;
    flex-direction:column;
    align-items:flex-end;
    gap:.35rem;
}

.permissions-page .perm-badges{
    display:flex;
    gap:.35rem;
    flex-wrap:wrap;
    justify-content:flex-end;
}

/* Switch */
.permissions-page .perm-toggle{
    width: 3rem !important;
    height: 1.35rem !important;
    cursor: pointer;
}

/* States (Ø£Ù„ÙˆØ§Ù† Ø®ÙÙŠÙØ©â€¦ Ø¨Ø¯ÙˆÙ† ØµØ±Ø§Ø®) */
.permissions-page .perm-row.is-role{
    background: #eff6ff;
    border-right: 4px solid rgba(var(--primary-rgb), .85);
}
.permissions-page .perm-row.is-direct{
    background: #f0fdf4;
    border-right: 4px solid #22c55e;
}
.permissions-page .perm-row.is-revoked{
    background: #fff5f5;
    border-right: 4px solid rgba(var(--danger-rgb), .85);
    opacity: .95;
}
.permissions-page .perm-row.is-off{
    background: var(--perm-surface);
    border-right: 4px solid transparent;
}
.permissions-page .perm-row.is-dirty{
    outline: 2px solid rgba(245, 158, 11, .4);
    outline-offset: 2px;
    animation: permDirtyPulse 2s ease-in-out infinite;
}

@keyframes permDirtyPulse {
    0%, 100% {
        outline-color: rgba(245, 158, 11, .4);
    }
    50% {
        outline-color: rgba(245, 158, 11, .7);
    }
}

/* Smooth transitions for state changes */
.permissions-page .perm-row{
    transition: all 0.3s ease;
}

/* Badge animations */
.permissions-page .perm-badges .badge{
    transition: all 0.2s ease;
}
.permissions-page .perm-badges .badge:hover{
    transform: scale(1.05);
}

/* Loading overlay */
.permissions-page .perm-loading{
    position:absolute;
    inset:0;
    background: rgba(255,255,255,.95);
    backdrop-filter: blur(4px);
    -webkit-backdrop-filter: blur(4px);
    display:flex;
    align-items:center;
    justify-content:center;
    z-index: 100;
    border-radius: 14px;
    transition: opacity 0.3s ease, visibility 0.3s ease;
}
.permissions-page .perm-loading .spinner-border{
    width: 3rem;
    height: 3rem;
    border-width: 4px;
    border-color: rgba(var(--primary-rgb), .3);
    border-right-color: transparent;
}
.permissions-page .perm-loading .text-muted{
    font-size: 1rem;
    font-weight: 600;
    color: var(--perm-muted);
    margin-top: 1rem;
}

/* ===== Select2 (ÙˆØ§Ø¶Ø­ Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¥Ù†Ù‡ Input) ===== */
.permissions-page .select2-container{
    width:100% !important;
}
.permissions-page .select2-container--default .select2-selection--single{
    height: 44px !important;
    border: 1px solid var(--perm-border) !important;
    border-radius: 12px !important;
    background: var(--perm-surface) !important;
    display:flex !important;
    align-items:center !important;
}
.permissions-page .select2-container--default .select2-selection--single:hover{
    border-color: rgba(var(--primary-rgb), .75) !important;
}
.permissions-page .select2-container--default.select2-container--focus .select2-selection--single{
    border-color: rgba(var(--primary-rgb), .85) !important;
    box-shadow: 0 0 0 .2rem rgba(var(--primary-rgb), .12) !important;
}
.permissions-page .select2-container--default .select2-selection--single .select2-selection__rendered{
    line-height: 44px !important;
    padding-right: 12px !important;
    padding-left: 40px !important;
    font-weight: 700;
    color: var(--perm-text) !important;
}
.permissions-page .select2-container--default .select2-selection--single .select2-selection__arrow{
    height: 44px !important;
    left: 10px !important;
    right: auto !important;
}
.permissions-page .select2-dropdown{
    border: 1px solid var(--perm-border) !important;
    border-radius: 12px !important;
    box-shadow: 0 8px 20px rgba(0,0,0,.08) !important;
    overflow:hidden;
}
.permissions-page .select2-results__option{
    padding: 10px 12px !important;
}
.permissions-page .select2-results__option--highlighted{
    background: rgba(var(--primary-rgb), .85) !important;
    color:#fff !important;
}

/* Buttons improvements */
.permissions-page .btn{
    font-weight: 600;
    border-radius: 12px;
    padding: .6rem 1.25rem;
    transition: all 0.2s ease;
}
.permissions-page .btn:hover{
    transform: translateY(-1px);
    box-shadow: 0 4px 8px rgba(0,0,0,.1);
}
.permissions-page .btn:active{
    transform: translateY(0);
}
.permissions-page .btn:disabled{
    opacity: 0.6;
    cursor: not-allowed;
    transform: none !important;
}

/* Expand/Collapse buttons */
.permissions-page #expandAllBtn,
.permissions-page #collapseAllBtn{
    font-weight: 600;
    padding: .4rem .75rem;
    font-size: .85rem;
}

/* Group actions buttons */
.permissions-page .perm-group-enable,
.permissions-page .perm-group-disable{
    font-weight: 600;
    font-size: .8rem;
    padding: .3rem .6rem;
    border-radius: 8px;
    transition: all 0.2s ease;
}
.permissions-page .perm-group-enable:hover,
.permissions-page .perm-group-disable:hover{
    transform: translateY(-1px);
    box-shadow: 0 2px 4px rgba(0,0,0,.1);
}

/* Badge improvements */
.permissions-page .perm-badges .badge{
    font-weight: 600;
    font-size: .75rem;
    padding: .35rem .6rem;
    border-radius: 8px;
}

/* Row improvements */
.permissions-page .perm-row{
    transition: all 0.2s ease;
}
.permissions-page .perm-row:hover{
    border-color: rgba(var(--primary-rgb), .4);
    box-shadow: 0 2px 8px rgba(0,0,0,.06);
    transform: translateY(-1px);
}
